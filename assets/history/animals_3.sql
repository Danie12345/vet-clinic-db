-- create table vets(
--     id int generated by default as identity (start with 1 increment by 1),
--     name text not null,
--     age int not null,
--     date_of_graduation date not null,
--     primary key (id)
-- );

-- create table specializations(
--     species_id int,
--     vets_id int
-- );

-- create table visits(
--     animals_id int not null,
--     vets_id int not null,
--     date_of_visit date not null
-- );

-- insert into 
--     vets (name, age, date_of_graduation)
-- values
--     ('William Tatcher', 45, '2000-04-23'),
--     ('Maisy Smith', 26, '2019-01-17'),
--     ('Stephanie Mendez', 64, '1981-05-04'),
--     ('Jack Harkness', 38, '2008-06-08');

-- insert into 
--     specializations (species_id, vets_id)
-- select s.id as species_id , v.id as vets_id from vets v
-- join species s
-- on v.name = 'William Tatcher' and s.name = 'Pokemon';
-- insert into 
--     specializations (species_id, vets_id)
-- select s.id as species_id , v.id as vets_id from vets v
-- join species s
-- on v.name = 'Stephanie Mendez' and s.name in ('Pokemon', 'Digimon');
-- insert into 
--     specializations (species_id, vets_id)
-- select s.id as species_id , v.id as vets_id from vets v
-- join species s
-- on v.name = 'Jack Harkness' and s.name = 'Digimon';

-- insert into 
--     visits (animals_id, vets_id, date_of_visit)
-- values
--     (
--         (select a.id from animals a where a.name = 'Agumon'),
--         (select v.id from vets v where v.name = 'William Tatcher'),
--         '2020-05-24'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Agumon'),
--         (select v.id from vets v where v.name = 'Stephanie Mendez'),
--         '2020-07-22'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Gabumon'),
--         (select v.id from vets v where v.name = 'Jack Harkness'),
--         '2021-02-02'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Pikachu'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2020-01-05'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Pikachu'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2020-03-08'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Pikachu'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2020-05-14'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Devimon'),
--         (select v.id from vets v where v.name = 'Stephanie Mendez'),
--         '2021-05-04'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Charmander'),
--         (select v.id from vets v where v.name = 'Jack Harkness'),
--         '2021-02-24'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Plantmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2019-12-21'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Plantmon'),
--         (select v.id from vets v where v.name = 'William Tatcher'),
--         '2019-12-21'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Plantmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2021-04-07'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Squirtle'),
--         (select v.id from vets v where v.name = 'Stephanie Mendez'),
--         '2019-09-29'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Angemon'),
--         (select v.id from vets v where v.name = 'Jack Harkness'),
--         '2020-10-03'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Angemon'),
--         (select v.id from vets v where v.name = 'Jack Harkness'),
--         '2020-11-04'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Boarmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2019-01-24'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Boarmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2019-05-15'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Boarmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2020-02-27'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Boarmon'),
--         (select v.id from vets v where v.name = 'Maisy Smith'),
--         '2020-08-03'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Blossom'),
--         (select v.id from vets v where v.name = 'Stephanie Mendez'),
--         '2020-05-24'
--     ),
--     (
--         (select a.id from animals a where a.name = 'Blossom'),
--         (select v.id from vets v where v.name = 'William Tatcher'),
--         '2021-01-11'
--     );

-- select name from animals
-- where id = (
--     select animals_id from visits v
--     where v.vets_id = (
--         select id from vets
--         where name = 'William Tatcher'
--     )
--     order by v.date_of_visit desc
--     limit 1
-- );

-- select count(*) as "total animals" from (
--     select animals_id from visits v
--     where v.vets_id = (
--         select id from vets
--         where name = 'Stephanie Mendez'
--     )
--     group by animals_id
-- ) as total;

-- select v.name as "vet name", s.name as "specialties" from vets v
-- left join specializations sp
--     on v.id = sp.vets_id
-- left join species s
--     on s.id = sp.species_id;

-- select a.name as "animal", vi.date_of_visit as "visit on" from visits vi
-- join animals a
--     on a.id = vi.animals_id
-- where
--     vi.date_of_visit > '2020-04-01' 
--     and vi.date_of_visit < '2020-08-30'
--     and vi.vets_id = (select ve.id from vets ve where ve.name = 'Stephanie Mendez');

-- select name from animals
-- where id = (
--     select animals_id from visits
--     group by animals_id
--     order by count(animals_id) desc
--     limit 1
-- );

-- select a.name as "animal" from visits vi
-- join animals a
--     on a.id = vi.animals_id
-- where
--     vi.vets_id = (select ve.id from vets ve where ve.name = 'Maisy Smith')
-- order by vi.date_of_visit asc
-- limit 1;

-- select vi.date_of_visit, a.*, ve.* from visits vi
-- join animals a
--     on a.id = vi.animals_id
-- join vets ve
--     on vi.vets_id = ve.id
-- order by vi.date_of_visit desc
-- limit 1;

-- select * from visits vi
-- full join animals a
--     on vi.animals_id = a.id
-- full join species s
--     on s.id = a.species_id
-- full join specializations as sp
--     on a.species_id = sp.species_id
-- full join vets ve
--     on sp.vets_id = ve.id
-- where a.species_id = sp.species_id and ve.id = sp.vets_id

-- select ve.name as "vet", s.name as "spesh species", a.name as "pet" from vets ve
-- full join specializations sp
--     on sp.vets_id = ve.id
-- full join species s
--     on s.id = sp.species_id
-- full join animals a
--     on a.species_id = s.id
-- -- where a.species_id = sp.vets_id

-- select count(*) as "unprofessional visits" from visits vi
-- join animals a
--     on vi.animals_id = a.id
-- where a.species_id not in (
--     select coalesce(specializations.species_id,0) from vets
--     left outer join specializations
--         on (specializations.vets_id = vets.id)
--     where vets.id = vi.vets_id
-- );

-- select s.name as "considered specialization" from animals a
-- join (
--     select max(animals_id) as most from visits vi
--     join vets ve
--         on ve.id = vi.vets_id
--     where ve.name = 'Maisy Smith'
-- ) as f
--     on a.id = most
-- join species s
--     on a.species_id = s.id;

-- select a.name, s.name from animals a
-- join species s
--     on a.species_id = s.id

-- select name from (
--     select s.name, count(s.name) from species s
--     join animals a
--         on s.id = a.species_id
--     join visits vi
--         on a.id = vi.animals_id
--     join vets ve
--         on vi.vets_id = ve.id
--     where ve.name = 'Maisy Smith'
--     group by s.name
-- ) as f
-- order by f.count desc
-- limit 1;